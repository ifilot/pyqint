

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Population Analysis &mdash; PyQInt  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=ede6f590" />
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Symmetry-adapted basis sets" href="symmetry_adapted_basis.html" />
    <link rel="prev" title="Geometry optimization" href="geometry_optimization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PyQInt
              <img src="_static/pyqint_logo_128.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="basis_functions.html">Basis functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="integral_evaluation.html">Integral evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="basis_sets_and_molecules.html">Basis sets and molecules</a></li>
<li class="toctree-l1"><a class="reference internal" href="electronic_structure_calculations.html">Electronic structure calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="molecular_orbital_diagrams.html">Molecular Orbital Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="orbital_visualization.html">Orbital visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="orbital_localization.html">Orbital localization: Foster-Boys</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_visualization.html">Matrix visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry_optimization.html">Geometry optimization</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Population Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#single-atom-population-analysis">Single Atom Population Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mulliken-population-analysis">Mulliken Population Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lowdin-population-analysis">Löwdin Population Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-atomic-charge-analysis">Example: Atomic Charge Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#molecular-orbital-hamilton-and-overlap-population-analysis">Molecular Orbital Hamilton and Overlap Population Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#background-of-mohp-moop-and-mobi">Background of MOHP, MOOP, and MOBI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#procedure-of-mohp-moop-and-mobi">Procedure of MOHP, MOOP, and MOBI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mohp-moop-and-mobi-analysis-of-foster-boys-localized-orbitals">MOHP, MOOP, and MOBI analysis of Foster-Boys localized orbitals</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="symmetry_adapted_basis.html">Symmetry-adapted basis sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="community_guidelines.html">Community guidelines</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyQInt</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div style="text-align: right;">
<a href="https://github.com/ifilot/pyqint" target="_blank"><i class="fa-brands fa-github"></i> Github</a>
</div>
<hr>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="population-analysis">
<span id="index-0"></span><h1><a class="toc-backref" href="#id1" role="doc-backlink">Population Analysis</a><a class="headerlink" href="#population-analysis" title="Link to this heading"></a></h1>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#population-analysis" id="id1">Population Analysis</a></p>
<ul>
<li><p><a class="reference internal" href="#single-atom-population-analysis" id="id2">Single Atom Population Analysis</a></p>
<ul>
<li><p><a class="reference internal" href="#mulliken-population-analysis" id="id3">Mulliken Population Analysis</a></p></li>
<li><p><a class="reference internal" href="#lowdin-population-analysis" id="id4">Löwdin Population Analysis</a></p></li>
<li><p><a class="reference internal" href="#example-atomic-charge-analysis" id="id5">Example: Atomic Charge Analysis</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#molecular-orbital-hamilton-and-overlap-population-analysis" id="id6">Molecular Orbital Hamilton and Overlap Population Analysis</a></p>
<ul>
<li><p><a class="reference internal" href="#background-of-mohp-moop-and-mobi" id="id7">Background of MOHP, MOOP, and MOBI</a></p></li>
<li><p><a class="reference internal" href="#procedure-of-mohp-moop-and-mobi" id="id8">Procedure of MOHP, MOOP, and MOBI</a></p></li>
<li><p><a class="reference internal" href="#mohp-moop-and-mobi-analysis-of-foster-boys-localized-orbitals" id="id9">MOHP, MOOP, and MOBI analysis of Foster-Boys localized orbitals</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Population Analysis methods currently only support <strong>restricted</strong>
Hartree-Fock calculations.</p>
</div>
<section id="single-atom-population-analysis">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Single Atom Population Analysis</a><a class="headerlink" href="#single-atom-population-analysis" title="Link to this heading"></a></h2>
<p>Single-atom population analysis aims to assign an effective electronic
population (and corresponding atomic charge) to each atom in a molecule by
partitioning the total electron density among atom-centered basis functions.
While such atomic charges are not quantum-mechanical observables, they are
widely used as qualitative indicators of charge transfer, polarity, and
chemical bonding.</p>
<p>In <strong class="program">PyQInt</strong>, two closely related single-atom population analysis
techniques are implemented:</p>
<ul class="simple">
<li><p><strong>Mulliken Population Analysis</strong></p></li>
<li><p><strong>Löwdin Population Analysis</strong></p></li>
</ul>
<p>Both methods operate on the one-particle density matrix expressed in a
localized atomic orbital basis.</p>
<section id="mulliken-population-analysis">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Mulliken Population Analysis</a><a class="headerlink" href="#mulliken-population-analysis" title="Link to this heading"></a></h3>
<p>In Mulliken population analysis, the electronic population associated with
atom <span class="math notranslate nohighlight">\(A\)</span> is obtained by summing the diagonal elements of the
<em>overlap-weighted density matrix</em> corresponding to basis functions centered on
that atom.</p>
<p>The overlap-weighted density matrix is defined as</p>
<div class="math notranslate nohighlight">
\[\mathbf{P}^{(\mathrm{M})} = \mathbf{P}\mathbf{S}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{P}\)</span> is the density matrix and <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> is the
overlap matrix.</p>
<p>The Mulliken population of atom <span class="math notranslate nohighlight">\(A\)</span> is then given by</p>
<div class="math notranslate nohighlight">
\[N_A^{(\mathrm{M})} =
\sum_{i \in A} P^{(\mathrm{M})}_{ii}\]</div>
<p>and the corresponding Mulliken atomic charge is</p>
<div class="math notranslate nohighlight">
\[q_A^{(\mathrm{M})} = Z_A - N_A^{(\mathrm{M})}\]</div>
<p>where <span class="math notranslate nohighlight">\(Z_A\)</span> is the nuclear charge of atom <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>Mulliken population analysis is straightforward to compute but is known to be
highly sensitive to the choice of basis set, particularly in the presence of
diffuse or highly overlapping basis functions.</p>
</section>
<section id="lowdin-population-analysis">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Löwdin Population Analysis</a><a class="headerlink" href="#lowdin-population-analysis" title="Link to this heading"></a></h3>
<p>Löwdin population analysis mitigates some of the basis-set dependence of
Mulliken analysis by first transforming the density matrix into an
orthonormalized basis using Löwdin symmetric orthogonalization.</p>
<p>The Löwdin orthogonalization matrix is defined as</p>
<div class="math notranslate nohighlight">
\[\mathbf{X} = \mathbf{S}^{-1/2}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> is the overlap matrix. The density matrix in the
orthonormalized basis is then given by</p>
<div class="math notranslate nohighlight">
\[\mathbf{P}' = \mathbf{X}\mathbf{P}\mathbf{X}\]</div>
<p>The Löwdin population of atom <span class="math notranslate nohighlight">\(A\)</span> is obtained as</p>
<div class="math notranslate nohighlight">
\[N_A^{(\mathrm{L})} =
\sum_{i \in A} P'_{ii}\]</div>
<p>with the corresponding Löwdin atomic charge</p>
<div class="math notranslate nohighlight">
\[q_A^{(\mathrm{L})} = Z_A - N_A^{(\mathrm{L})}\]</div>
<p>Because the Löwdin transformation produces an orthonormal basis, Löwdin
populations are generally more stable with respect to basis-set variations and
are often regarded as more physically meaningful than Mulliken populations.</p>
</section>
<section id="example-atomic-charge-analysis">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Example: Atomic Charge Analysis</a><a class="headerlink" href="#example-atomic-charge-analysis" title="Link to this heading"></a></h3>
<p>The following example demonstrates Mulliken and Löwdin atomic charge analysis
for methane (CH<sub>4</sub>) using a minimal STO-3G basis set.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyqint</span><span class="w"> </span><span class="kn">import</span> <span class="n">MoleculeBuilder</span><span class="p">,</span> <span class="n">HF</span><span class="p">,</span> <span class="n">PopulationAnalysis</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">MoleculeBuilder</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="s1">&#39;CH4&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s1">&#39;sto3g&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rhf</span><span class="p">()</span>
<span class="n">pa</span> <span class="o">=</span> <span class="n">PopulationAnalysis</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="n">charges_mulliken</span> <span class="o">=</span> <span class="p">[</span><span class="n">pa</span><span class="o">.</span><span class="n">mulliken</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="p">))]</span>
<span class="n">charges_lowdin</span>   <span class="o">=</span> <span class="p">[</span><span class="n">pa</span><span class="o">.</span><span class="n">lowdin</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>   <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="p">))]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Symbol  Lowdin        Mulliken&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">cl</span><span class="p">,</span> <span class="n">cm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">charges_lowdin</span><span class="p">,</span> <span class="n">charges_mulliken</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%2s</span><span class="s1">  </span><span class="si">%12.6f</span><span class="s1">  </span><span class="si">%12.6f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cl</span><span class="p">,</span> <span class="n">cm</span><span class="p">))</span>
</pre></div>
</div>
<p>Example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Symbol</span>  <span class="n">Lowdin</span>        <span class="n">Mulliken</span>
 <span class="n">C</span>     <span class="o">-</span><span class="mf">0.134084</span>     <span class="o">-</span><span class="mf">0.248559</span>
 <span class="n">H</span>      <span class="mf">0.033521</span>      <span class="mf">0.062140</span>
 <span class="n">H</span>      <span class="mf">0.033521</span>      <span class="mf">0.062140</span>
 <span class="n">H</span>      <span class="mf">0.033521</span>      <span class="mf">0.062140</span>
 <span class="n">H</span>      <span class="mf">0.033521</span>      <span class="mf">0.062140</span>
</pre></div>
</div>
<p>In both population analysis schemes, carbon carries a net negative charge,
while the four hydrogen atoms carry equal positive charges, reflecting the
tetrahedral symmetry of the molecule. The Löwdin charges are smaller in
magnitude than the Mulliken charges, consistent with the reduced basis-set
sensitivity of Löwdin population analysis.</p>
<p>For neutral molecules, the sum of all atomic charges obtained from either scheme
is exactly zero.</p>
</section>
</section>
<section id="molecular-orbital-hamilton-and-overlap-population-analysis">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Molecular Orbital Hamilton and Overlap Population Analysis</a><a class="headerlink" href="#molecular-orbital-hamilton-and-overlap-population-analysis" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In earlier versions of <strong class="program">PyQInt</strong>, this functionality was
erroneously referred to as <em>Crystal Orbital Hamilton Population</em> (COHP).
While the underlying idea is closely related, COHP is formally defined
for <em>crystal orbitals</em> (Bloch functions) in periodic systems.</p>
</div>
<section id="background-of-mohp-moop-and-mobi">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Background of MOHP, MOOP, and MOBI</a><a class="headerlink" href="#background-of-mohp-moop-and-mobi" title="Link to this heading"></a></h3>
<p>Within the scope of chemical bonding analysis, molecular orbitals can be
classified as bonding, antibonding, or non-bonding with respect to any given
pair of atoms. When working with localized basis functions, this classification
can be made explicit by projecting molecular orbitals onto atomic subspaces.</p>
<p>Two closely related population analysis techniques are implemented in <em>pyqint</em>:</p>
<ul class="simple">
<li><p><strong>MOHP</strong> - Molecular Orbital <em>Hamilton</em> Population</p></li>
<li><p><strong>MOOP</strong> - Molecular Orbital <em>Overlap</em> Population</p></li>
<li><p><strong>MOBI</strong> - Molecular Orbital <em>Bond</em> Index</p></li>
</ul>
<p>All three analyses quantify the contribution of a given molecular orbital to the
interaction between two atoms.</p>
<p>In a localized basis representation, the <strong>MOHP coefficient</strong> of molecular
orbital <span class="math notranslate nohighlight">\(k\)</span> with respect to atoms <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\mathrm{MOHP}_k =
2 \sum_{i \in A} \sum_{j \in B}
C_{ik} \, H_{ij} \, C_{jk}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C_{ik}\)</span> and <span class="math notranslate nohighlight">\(C_{jk}\)</span> are elements of the molecular orbital
coefficient matrix <span class="math notranslate nohighlight">\(\mathbf{C}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(H_{ij}\)</span> is an element of the Fock (Hamiltonian) matrix</p></li>
<li><p>the factor of 2 accounts for spin degeneracy in restricted Hartree-Fock theory</p></li>
</ul>
<p>Analogously, the <strong>MOOP coefficient</strong> is defined as</p>
<div class="math notranslate nohighlight">
\[\mathrm{MOOP}_k =
2 \sum_{i \in A} \sum_{j \in B}
C_{ik} \, S_{ij} \, C_{jk}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_{ij}\)</span> is an element of the overlap matrix <span class="math notranslate nohighlight">\(\mathbf{S}\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both MOHP and MOOP can be evaluated for virtual (unoccupied) orbitals.
However, the interpretation of such values should be made with caution,
as virtual orbitals do not correspond to occupied electronic states.</p>
</div>
<p>Lastly, the <strong>MOBI coefficient</strong> is defined as</p>
<div class="math notranslate nohighlight">
\[\mathrm{MOBI}_k =
2 \sum_{i \in A} \sum_{j \in B}
C_{ik} \, P_{ij} \, C_{jk}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{ij}\)</span> is an element of the density matrix <span class="math notranslate nohighlight">\(\mathbf{P}\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MOHP, MOOP, and MOBI can be evaluated for virtual (unoccupied) orbitals.
However, the interpretation of such values should be made with caution,
as virtual orbitals do not correspond to occupied electronic states.</p>
</div>
</section>
<section id="procedure-of-mohp-moop-and-mobi">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Procedure of MOHP, MOOP, and MOBI</a><a class="headerlink" href="#procedure-of-mohp-moop-and-mobi" title="Link to this heading"></a></h3>
<p>MOHP, MOOP, and MOBI calculations are performed using the <cite>PopulationAnalysis</cite> class,
which takes the output of a Hartree-Fock calculation as input.</p>
<p>The example below demonstrates MOHP, MOOP, and MOBI analysis for the CO molecule.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyqint</span><span class="w"> </span><span class="kn">import</span> <span class="n">MoleculeBuilder</span><span class="p">,</span> <span class="n">HF</span><span class="p">,</span> <span class="n">PopulationAnalysis</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">MoleculeBuilder</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="s1">&#39;CO&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s1">&#39;sto3g&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rhf</span><span class="p">()</span>
<span class="n">mopa</span> <span class="o">=</span> <span class="n">PopulationAnalysis</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="n">mohp</span> <span class="o">=</span> <span class="n">mopa</span><span class="o">.</span><span class="n">mohp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">moop</span> <span class="o">=</span> <span class="n">mopa</span><span class="o">.</span><span class="n">moop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mobi</span> <span class="o">=</span> <span class="n">mopa</span><span class="o">.</span><span class="n">mobi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MOHP, MOOP, and MOBI values of canonical Hartree-Fock orbitals&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;orbe&#39;</span><span class="p">],</span> <span class="n">mohp</span><span class="p">,</span> <span class="n">moop</span><span class="p">,</span> <span class="n">mobi</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%3i</span><span class="s1"> </span><span class="si">%12.4f</span><span class="s1"> </span><span class="si">%12.4f</span><span class="s1"> </span><span class="si">%12.4f</span><span class="s1"> </span><span class="si">%12.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
<p>Example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MOHP</span><span class="p">,</span> <span class="n">MOOP</span><span class="p">,</span> <span class="ow">and</span> <span class="n">MOBI</span> <span class="n">values</span> <span class="n">of</span> <span class="n">canonical</span> <span class="n">Hartree</span><span class="o">-</span><span class="n">Fock</span> <span class="n">orbitals</span>
  <span class="mi">1</span>     <span class="o">-</span><span class="mf">20.3914</span>       <span class="mf">0.0319</span>      <span class="o">-</span><span class="mf">0.0017</span>      <span class="o">+</span><span class="mf">0.0005</span>
  <span class="mi">2</span>     <span class="o">-</span><span class="mf">11.0902</span>       <span class="mf">0.0094</span>      <span class="o">-</span><span class="mf">0.0009</span>      <span class="o">+</span><span class="mf">0.0003</span>
  <span class="mi">3</span>      <span class="o">-</span><span class="mf">1.4047</span>      <span class="o">-</span><span class="mf">0.4347</span>       <span class="mf">0.2937</span>      <span class="o">-</span><span class="mf">0.0219</span>
  <span class="mi">4</span>      <span class="o">-</span><span class="mf">0.6899</span>       <span class="mf">0.1977</span>      <span class="o">-</span><span class="mf">0.0663</span>      <span class="o">+</span><span class="mf">0.3657</span>
  <span class="mi">5</span>      <span class="o">-</span><span class="mf">0.5094</span>      <span class="o">-</span><span class="mf">0.2736</span>       <span class="mf">0.1562</span>      <span class="o">+</span><span class="mf">0.5121</span>
  <span class="mi">6</span>      <span class="o">-</span><span class="mf">0.5094</span>      <span class="o">-</span><span class="mf">0.2736</span>       <span class="mf">0.1562</span>      <span class="o">+</span><span class="mf">0.5121</span>
  <span class="mi">7</span>      <span class="o">-</span><span class="mf">0.4409</span>       <span class="mf">0.0813</span>      <span class="o">-</span><span class="mf">0.0375</span>      <span class="o">+</span><span class="mf">0.2263</span>
  <span class="mi">8</span>       <span class="mf">0.2865</span>       <span class="mf">0.4489</span>      <span class="o">-</span><span class="mf">0.2562</span>      <span class="o">-</span><span class="mf">0.8401</span>
  <span class="mi">9</span>       <span class="mf">0.2865</span>       <span class="mf">0.4489</span>      <span class="o">-</span><span class="mf">0.2562</span>      <span class="o">-</span><span class="mf">0.8401</span>
 <span class="mi">10</span>       <span class="mf">0.9253</span>       <span class="mf">5.1204</span>      <span class="o">-</span><span class="mf">2.6744</span>      <span class="o">-</span><span class="mf">1.4625</span>
</pre></div>
</div>
</section>
<section id="mohp-moop-and-mobi-analysis-of-foster-boys-localized-orbitals">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">MOHP, MOOP, and MOBI analysis of Foster-Boys localized orbitals</a><a class="headerlink" href="#mohp-moop-and-mobi-analysis-of-foster-boys-localized-orbitals" title="Link to this heading"></a></h3>
<p>It is often insightful to perform population analysis on <em>localized</em>
molecular orbitals. Since Foster-Boys localization corresponds to a unitary
transformation of the occupied orbital subspace, the output of a
Foster-Boys localization can be passed directly to the <cite>PopulationAnalysis</cite> class.</p>
<p>The example below compares MOHP values obtained from canonical and
Foster-Boys localized orbitals.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pyqint</span><span class="w"> </span><span class="kn">import</span> <span class="n">MoleculeBuilder</span><span class="p">,</span> <span class="n">HF</span><span class="p">,</span> <span class="n">FosterBoys</span><span class="p">,</span> <span class="n">PopulationAnalysis</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">MoleculeBuilder</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="s1">&#39;CO&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">HF</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s1">&#39;sto3g&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rhf</span><span class="p">()</span>
<span class="n">mopa</span> <span class="o">=</span> <span class="n">PopulationAnalysis</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="n">mohp</span> <span class="o">=</span> <span class="n">mopa</span><span class="o">.</span><span class="n">mohp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">moop</span> <span class="o">=</span> <span class="n">mopa</span><span class="o">.</span><span class="n">moop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mobi</span> <span class="o">=</span> <span class="n">mopa</span><span class="o">.</span><span class="n">mobi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">res_fb</span> <span class="o">=</span> <span class="n">FosterBoys</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mopa_fb</span> <span class="o">=</span> <span class="n">PopulationAnalysis</span><span class="p">(</span><span class="n">res_fb</span><span class="p">)</span>
<span class="n">mohp_fb</span> <span class="o">=</span> <span class="n">mopa_fb</span><span class="o">.</span><span class="n">mohp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">moop_fb</span> <span class="o">=</span> <span class="n">mopa_fb</span><span class="o">.</span><span class="n">moop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mobi_fb</span> <span class="o">=</span> <span class="n">mopa_fb</span><span class="o">.</span><span class="n">mobi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sum of MOHP (canonical orbitals):&#39;</span><span class="p">,</span>
      <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mohp</span><span class="p">[:</span><span class="mi">7</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sum of MOHP (Foster-Boys orbitals):&#39;</span><span class="p">,</span>
      <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mohp_fb</span><span class="p">[:</span><span class="mi">7</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sum of MOOP (canonical orbitals):&#39;</span><span class="p">,</span>
      <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">moop</span><span class="p">[:</span><span class="mi">7</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sum of MOOP (Foster-Boys orbitals):&#39;</span><span class="p">,</span>
      <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">moop_fb</span><span class="p">[:</span><span class="mi">7</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sum of MOBI (canonical orbitals):&#39;</span><span class="p">,</span>
      <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mobi</span><span class="p">[:</span><span class="mi">7</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sum of MOBI (Foster-Boys orbitals):&#39;</span><span class="p">,</span>
      <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mobi_fb</span><span class="p">[:</span><span class="mi">7</span><span class="p">]))</span>
</pre></div>
</div>
<p>Example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Sum</span> <span class="n">of</span> <span class="n">MOHP</span> <span class="p">(</span><span class="n">canonical</span> <span class="n">orbitals</span><span class="p">):</span> <span class="o">-</span><span class="mf">0.6617486641766972</span>
<span class="n">Sum</span> <span class="n">of</span> <span class="n">MOHP</span> <span class="p">(</span><span class="n">Foster</span><span class="o">-</span><span class="n">Boys</span> <span class="n">orbitals</span><span class="p">):</span> <span class="o">-</span><span class="mf">0.6617486641766972</span>
<span class="n">Sum</span> <span class="n">of</span> <span class="n">MOOP</span> <span class="p">(</span><span class="n">canonical</span> <span class="n">orbitals</span><span class="p">):</span> <span class="mf">0.49960515685531653</span>
<span class="n">Sum</span> <span class="n">of</span> <span class="n">MOOP</span> <span class="p">(</span><span class="n">Foster</span><span class="o">-</span><span class="n">Boys</span> <span class="n">orbitals</span><span class="p">):</span> <span class="mf">0.49960515685531626</span>
<span class="n">Sum</span> <span class="n">of</span> <span class="n">MOBI</span> <span class="p">(</span><span class="n">canonical</span> <span class="n">orbitals</span><span class="p">):</span> <span class="mf">1.5951431033478687</span>
<span class="n">Sum</span> <span class="n">of</span> <span class="n">MOBI</span> <span class="p">(</span><span class="n">Foster</span><span class="o">-</span><span class="n">Boys</span> <span class="n">orbitals</span><span class="p">):</span> <span class="mf">1.5951431033478685</span>
</pre></div>
</div>
<p>The results demonstrate that while individual MOHP, MOOP, and MOBI contributions may
differ significantly between canonical and localized orbitals, the <strong>sum over
the occupied subspace is invariant under unitary transformations</strong>. This
invariance reflects the fact that the total bonding character, electron density,
and total energy of the system are preserved under orbital localization
procedures.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="geometry_optimization.html" class="btn btn-neutral float-left" title="Geometry optimization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="symmetry_adapted_basis.html" class="btn btn-neutral float-right" title="Symmetry-adapted basis sets" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Inorganic Materials and Catalysis.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>